knitr::opts_chunk$set(echo = TRUE)
# Required libraries
library(survival)
library(ggplot2)
surv_brca_cli<- read.csv("surv_brca_cli.csv")
surv_object <- Surv(time = surv_brca_cli$time_in_years, event = surv_brca_cli$vital_status)
#fit the kaplan maier model for pathologic stage
fit_path_stage <- survfit(surv_object ~ pathologic_stage , data = surv_brca_cli)
ggsurvplot(
fit_path_stage,
size = 1.5,                  # Line thickness
font.x = c(16, "bold"),      # Font size for X-axis
font.y = c(16, "bold"),      # Font size for Y-axis
font.tickslab = c(10),       # Font size for tick labels
legend = "right",             # Legend position
conf.int = TRUE,
risk.table = TRUE,
pval = TRUE,
xlab = "Time(years)",
ylab = "Survival Probability",
ggtheme = theme_minimal(),
legend.title = "pathological stage",
risk.table.height = 0.5,
surv.median.line = "hv"
)
#KM fit of the data
km_fit_path_stageII <- survfit(Surv(time= time, event=vital_status) ~ 1, data = subset(surv_brca_cli, pathologic_stage == "Stage II"))
km_fit_path_stageIII <- survfit(Surv(time= time, event=vital_status) ~ 1, data = subset(surv_brca_cli, pathologic_stage == "Stage III"))
####extract survival probabilities
# Manually define time points (e.g., every 30 days)
manual_times <- seq(0, max(surv_brca_cli$time, na.rm = TRUE), by = 1)
# Extract survival probabilities for Pathologic stage 2
surv_pathII <- summary(km_fit_path_stageII, times = manual_times, extend = TRUE)$surv
# Extract survival probabilities for pathologic stage 3
surv_pathIII <- summary(km_fit_path_stageIII, times = manual_times, extend = TRUE)$surv
# Survival ratios and confidence intervals
survival_ratio <- surv_pathII / surv_pathIII
surv_pathII
